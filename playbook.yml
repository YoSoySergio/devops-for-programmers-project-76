- hosts: all
  gather_facts: yes
  become: true

  roles:
    - { role: geerlingguy.pip, pip_install_packages: [docker, docker-compose] }

  tasks:
    - name: Copy docker-compose file
      ansible.builtin.template:
        src: ./docker/docker-compose.yml
        dest: "/home/docker-compose.yml"
    - name: Copy caddy config
      ansible.builtin.template:
        src: ./services/caddy/Caddyfile
        dest: "/home/Caddyfile"
    - name: Create and start services
      community.docker.docker_compose:
        # link the docker compose file in the docker folder
        project_src: "/home"
        remove_orphans: true
        debug: true
